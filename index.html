<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CoffeeChat ☕ | The Sassy Bot</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }
        
        :root {
            --primary: #FF6B35;
            --primary-dark: #E55A2B;
            --primary-light: #FF8E5C;
            --gradient: linear-gradient(135deg, #FF6B35 0%, #FF8E5C 100%);
            --gradient-dark: linear-gradient(135deg, #E55A2B 0%, #FF6B35 100%);
            --bg-dark: #0F0F1A;
            --bg-card: #1A1A2E;
            --bg-input: #25253D;
            --text: #FFFFFF;
            --text-secondary: #A0A0C0;
            --shadow: 0 10px 30px rgba(255, 107, 53, 0.15);
            --shadow-lg: 0 20px 50px rgba(255, 107, 53, 0.25);
            --border-radius: 20px;
            --border-radius-sm: 12px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        body {
            background-color: var(--bg-dark);
            color: var(--text);
            height: 100vh;
            overflow: hidden;
            position: relative;
        }
        
        /* Animated Background */
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.4;
            background: 
                radial-gradient(circle at 20% 80%, rgba(255, 107, 53, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 142, 92, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(26, 26, 46, 0.8) 0%, transparent 50%);
            animation: pulse 15s ease-in-out infinite alternate;
        }
        
        @keyframes pulse {
            0% { opacity: 0.3; }
            100% { opacity: 0.5; }
        }
        
        /* Main Layout Container */
        .app-container {
            display: flex;
            height: 100vh;
            width: 100%;
            position: relative;
        }
        
        /* Features Sidebar (Desktop only) */
        .features-sidebar {
            width: 320px;
            background: rgba(26, 26, 46, 0.8);
            backdrop-filter: blur(10px);
            border-right: 1px solid rgba(255, 107, 53, 0.1);
            display: flex;
            flex-direction: column;
            padding: 20px;
            overflow-y: auto;
            z-index: 10;
            display: none;
        }
        
        .features-sidebar.active {
            display: flex;
        }
        
        /* Main Chat Area */
        .main-chat-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
            position: relative;
        }
        
        /* Header - Fixed at top */
        .chat-header {
            background: rgba(15, 15, 26, 0.95);
            backdrop-filter: blur(20px);
            padding: 15px 20px;
            border-bottom: 1px solid rgba(255, 107, 53, 0.2);
            flex-shrink: 0;
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
            position: sticky;
            top: 0;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
            min-width: 0;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            padding: 5px 15px;
            border-radius: 50px;
            position: relative;
            overflow: hidden;
            max-width: 100%;
        }
        
        .logo::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--gradient);
            opacity: 0.1;
            z-index: -1;
            border-radius: 50px;
        }
        
        .logo-icon {
            font-size: 1.5rem;
            filter: drop-shadow(0 2px 5px rgba(255, 107, 53, 0.3));
            animation: float 3s ease-in-out infinite;
            flex-shrink: 0;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-3px); }
        }
        
        h1 {
            font-size: 1.4rem;
            font-weight: 700;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            flex: 1;
            min-width: 0;
        }
        
        .bot-info-mobile {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-left: 10px;
        }
        
        .bot-avatar-small {
            width: 36px;
            height: 36px;
            background: var(--gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            box-shadow: 0 3px 10px rgba(255, 107, 53, 0.3);
            flex-shrink: 0;
        }
        
        .chat-controls {
            display: flex;
            gap: 10px;
            flex-shrink: 0;
        }
        
        .chat-btn {
            background: rgba(255, 107, 53, 0.1);
            border: 1px solid rgba(255, 107, 53, 0.2);
            color: var(--text);
            padding: 8px 15px;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            backdrop-filter: blur(10px);
            flex-shrink: 0;
        }
        
        .chat-btn:hover {
            background: var(--gradient);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 53, 0.3);
        }
        
        /* Messages Container - Scrollable */
        .messages-container {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            scroll-behavior: smooth;
        }
        
        /* Empty state */
        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex: 1;
            text-align: center;
            padding: 40px 20px;
            opacity: 0.7;
        }
        
        .empty-state i {
            font-size: 4rem;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
        }
        
        /* Message styles */
        .message {
            display: flex;
            max-width: 85%;
            animation: slideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            flex-shrink: 0;
        }
        
        @keyframes slideIn {
            from { 
                opacity: 0; 
                transform: translateY(20px) scale(0.95); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0) scale(1); 
            }
        }
        
        .user-message {
            align-self: flex-end;
            flex-direction: row-reverse;
        }
        
        .bot-message {
            align-self: flex-start;
        }
        
        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            margin: 0 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .user-message .message-avatar {
            background: var(--gradient);
            color: white;
        }
        
        .bot-message .message-avatar {
            background: var(--gradient-dark);
            color: white;
        }
        
        .message-content {
            padding: 15px 20px;
            border-radius: 25px;
            position: relative;
            word-wrap: break-word;
            max-width: 100%;
            backdrop-filter: blur(10px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .user-message .message-content {
            background: var(--gradient);
            color: white;
            border-bottom-right-radius: 8px;
        }
        
        .bot-message .message-content {
            background: rgba(37, 37, 61, 0.8);
            color: var(--text);
            border-bottom-left-radius: 8px;
            border: 1px solid rgba(255, 107, 53, 0.1);
        }
        
        .message-time {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-top: 8px;
            text-align: right;
        }
        
        /* Input Container - Fixed at bottom */
        .input-container {
            background: rgba(15, 15, 26, 0.95);
            backdrop-filter: blur(20px);
            padding: 20px;
            border-top: 1px solid rgba(255, 107, 53, 0.1);
            flex-shrink: 0;
            position: sticky;
            bottom: 0;
            z-index: 100;
        }
        
        .input-wrapper {
            display: flex;
            gap: 15px;
            align-items: center;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .chat-input {
            flex: 1;
            padding: 16px 20px;
            border: none;
            border-radius: var(--border-radius-sm);
            background: var(--bg-input);
            color: var(--text);
            font-size: 1rem;
            outline: none;
            transition: var(--transition);
            border: 1px solid transparent;
            min-width: 0;
        }
        
        .chat-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(255, 107, 53, 0.2);
        }
        
        .send-button {
            width: 55px;
            height: 55px;
            border-radius: 50%;
            background: var(--gradient);
            border: none;
            color: white;
            font-size: 1.3rem;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            box-shadow: 0 5px 20px rgba(255, 107, 53, 0.3);
        }
        
        .send-button:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 25px rgba(255, 107, 53, 0.4);
        }
        
        /* Quick Actions */
        .quick-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .action-chip {
            background: rgba(255, 107, 53, 0.1);
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: var(--transition);
            border: 1px solid rgba(255, 107, 53, 0.2);
            flex-shrink: 0;
        }
        
        .action-chip:hover {
            background: var(--gradient);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 53, 0.3);
        }
        
        /* Features Panel (Mobile) */
        .features-panel {
            position: fixed;
            top: 0;
            right: -100%;
            width: 100%;
            height: 100%;
            background: rgba(15, 15, 26, 0.98);
            backdrop-filter: blur(20px);
            z-index: 1000;
            transition: right 0.3s ease;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }
        
        .features-panel.active {
            right: 0;
        }
        
        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 107, 53, 0.2);
        }
        
        .panel-title {
            font-size: 1.5rem;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .close-panel {
            background: none;
            border: none;
            color: var(--text);
            font-size: 1.5rem;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }
        
        .close-panel:hover {
            background: rgba(255, 107, 53, 0.1);
        }
        
        .feature-card {
            background: rgba(26, 26, 46, 0.7);
            backdrop-filter: blur(10px);
            border-radius: var(--border-radius);
            padding: 20px;
            border: 1px solid rgba(255, 107, 53, 0.1);
            transition: var(--transition);
            margin-bottom: 20px;
        }
        
        .feature-card h3 {
            color: var(--primary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.3rem;
            font-weight: 600;
        }
        
        .feature-card h3 i {
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .sassy-replies {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }
        
        .reply-chip {
            background: rgba(255, 107, 53, 0.1);
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: var(--transition);
            border: 1px solid rgba(255, 107, 53, 0.2);
            flex-shrink: 0;
        }
        
        .reply-chip:hover {
            background: var(--gradient);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 53, 0.3);
        }
        
        .viral-features {
            list-style-type: none;
        }
        
        .viral-features li {
            margin-bottom: 12px;
            padding-left: 28px;
            position: relative;
            font-size: 0.95rem;
            line-height: 1.5;
        }
        
        .viral-features li:before {
            content: "☕";
            position: absolute;
            left: 0;
            color: var(--primary);
            font-size: 1.2rem;
        }
        
        .share-button {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 12px;
            transition: var(--transition);
            width: 100%;
            justify-content: center;
            box-shadow: 0 5px 20px rgba(255, 107, 53, 0.3);
            margin-top: 10px;
        }
        
        .share-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(255, 107, 53, 0.4);
        }
        
        /* Typing indicator */
        .typing-indicator {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            background: rgba(37, 37, 61, 0.8);
            border-radius: 25px;
            width: fit-content;
            border-bottom-left-radius: 8px;
            border: 1px solid rgba(255, 107, 53, 0.1);
            backdrop-filter: blur(10px);
        }
        
        .typing-dot {
            width: 10px;
            height: 10px;
            background: var(--primary);
            border-radius: 50%;
            margin: 0 4px;
            animation: typing 1.4s infinite ease-in-out;
        }
        
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        
        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }
        
        /* Coffee animation */
        .coffee-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            opacity: 0.3;
        }
        
        .coffee-cup {
            position: absolute;
            font-size: 2rem;
            color: var(--primary);
            opacity: 0.5;
            animation: float 20s infinite linear;
            filter: drop-shadow(0 5px 15px rgba(255, 107, 53, 0.3));
        }
        
        @keyframes float {
            0% { transform: translateY(100vh) rotate(0deg) scale(1); }
            100% { transform: translateY(-100px) rotate(360deg) scale(1.2); }
        }
        
        /* Scrollbar styling */
        .messages-container::-webkit-scrollbar {
            width: 6px;
        }
        
        .messages-container::-webkit-scrollbar-track {
            background: rgba(15, 15, 26, 0.5);
            border-radius: 3px;
        }
        
        .messages-container::-webkit-scrollbar-thumb {
            background: var(--gradient);
            border-radius: 3px;
        }
        
        .messages-container::-webkit-scrollbar-thumb:hover {
            background: var(--gradient-dark);
        }
        
        /* Achievement Popup */
        .achievement-popup {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--gradient);
            color: white;
            padding: 15px 20px;
            border-radius: var(--border-radius-sm);
            box-shadow: var(--shadow-lg);
            display: none;
            align-items: center;
            gap: 12px;
            z-index: 1000;
            animation: slideInRight 0.5s ease-out;
            max-width: 300px;
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        /* Mobile Features Toggle */
        .mobile-features-toggle {
            display: none;
            background: rgba(255, 107, 53, 0.1);
            border: 1px solid rgba(255, 107, 53, 0.2);
            color: var(--text);
            padding: 10px 15px;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            transition: var(--transition);
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }
        
        .mobile-features-toggle:hover {
            background: var(--gradient);
        }
        
        /* Responsive Design */
        
    /* Responsive Design Fixes for Mobile */
    @media (max-width: 768px) {
        .app-container {
            flex-direction: column;
        }
        
        .features-sidebar {
            display: none !important;
        }
        
        .main-chat-area {
    width: 100%;
    height: 100vh;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    display: flex;
    flex-direction: column;
    overflow: hidden; /* ADD THIS */
}
        
        .chat-header {
            padding: 12px 15px;
            gap: 10px;
            flex-wrap: wrap;
            min-height: 70px;
        }
        
        .logo-container {
            flex: 0 0 auto;
            min-width: 0;
            max-width: 60%;
        }
        
        .logo {
            padding: 5px 10px;
        }
        
        h1 {
            font-size: 1.2rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 150px;
        }
        
        .logo-icon {
            font-size: 1.2rem;
        }
        
        .bot-info-mobile {
            margin-left: 5px;
            flex-shrink: 0;
        }
        
        .bot-avatar-small {
            width: 32px;
            height: 32px;
            font-size: 1rem;
        }
        
        .chat-controls {
            order: 3;
            width: 100%;
            justify-content: space-between;
            margin-top: 5px;
        }
        
        .chat-btn {
            width: 40px;
            height: 40px;
            padding: 0;
            justify-content: center;
            flex: 0 0 auto;
        }
        
        .chat-btn span {
            display: none;
        }
        
        .mobile-features-toggle {
            flex: 1;
            justify-content: center;
            max-width: 120px;
        }
        
        .messages-container {
    padding: 15px 12px 150px 12px;
    gap: 15px;
    flex: 1;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    min-height: 0;
    margin-bottom: 0;
}

        .message {
            max-width: 90%;
        }
        
        .message-content {
            padding: 12px 16px;
            font-size: 0.95rem;
        }
        
        .message-avatar {
            width: 35px;
            height: 35px;
            margin: 0 8px;
            font-size: 0.9rem;
        }
        
        .input-container {
    padding: 12px 15px;
    background: rgba(15, 15, 26, 0.98);
    backdrop-filter: blur(20px);
    border-top: 1px solid rgba(255, 107, 53, 0.2);
    height: 80px;
    flex-shrink: 0;
}
        
        .input-wrapper {
            gap: 10px;
        }
        
        .chat-input {
            padding: 14px 16px;
            font-size: 0.95rem;
            min-height: 50px;
        }
        
        .send-button {
            width: 50px;
            height: 50px;
            font-size: 1.2rem;
        }
        
        .quick-actions {
            display: none;
        }
        
        /* Features panel mobile improvements */
        .features-panel {
            z-index: 2000;
            padding-top: 70px; /* Account for status bar on mobile */
        }
        
        .panel-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(15, 15, 26, 0.98);
            backdrop-filter: blur(20px);
            z-index: 2001;
            padding: 15px 20px;
            margin-bottom: 0;
        }
        
        .feature-card {
            margin-bottom: 15px;
            padding: 15px;
        }
        
        .sassy-replies {
            gap: 8px;
        }
        
        .reply-chip {
            padding: 8px 12px;
            font-size: 0.85rem;
        }
        
        .share-button {
            padding: 12px 20px;
            font-size: 0.95rem;
        }
        
        /* Achievement popup mobile fix */
        .achievement-popup {
            top: 10px;
            right: 10px;
            left: 10px;
            max-width: none;
        }
    }
    
    @media (max-width: 480px) {
        .chat-header {
            min-height: 65px;
            padding: 10px 12px;
        }
        
        h1 {
            font-size: 1.1rem;
            max-width: 130px;
        }
        
        .logo {
            gap: 5px;
            padding: 4px 8px;
        }
        
        .logo-icon {
            font-size: 1.1rem;
        }
        
        .bot-avatar-small {
            width: 30px;
            height: 30px;
        }
        
        .bot-details .bot-name {
            font-size: 0.85rem;
        }
        
        .bot-details .bot-status {
            font-size: 0.65rem;
        }
        
        .chat-btn {
            width: 36px;
            height: 36px;
        }
        
        .mobile-features-toggle {
            font-size: 0.85rem;
            padding: 8px 12px;
        }
        
     .messages-container {
    padding: 12px 10px 150px 10px;
    gap: 12px;
    flex: 1;
    min-height: 0;
    margin-bottom: 0;
}
        
        .message {
            max-width: 95%;
        }
        
        .message-content {
            padding: 10px 14px;
            font-size: 0.9rem;
        }
        
        .message-avatar {
            width: 32px;
            height: 32px;
            margin: 0 6px;
        }
        
        .message-time {
            font-size: 0.7rem;
        }
        
        .input-container {
    padding: 10px 12px;
    position: fixed; /* ADD THIS */
    bottom: 0; /* ADD THIS */
    left: 0; /* ADD THIS */
    right: 0; /* ADD THIS */
    height: 75px;
    z-index: 1000; /* ADD THIS */
}
        
        .chat-input {
            padding: 12px 14px;
            font-size: 0.9rem;
            min-height: 48px;
        }
        
        .send-button {
            width: 48px;
            height: 48px;
            font-size: 1.1rem;
        }
        
        .feature-card h3 {
            font-size: 1.2rem;
        }
        
        .viral-features li {
            font-size: 0.9rem;
            margin-bottom: 10px;
        }
    }
    
    @media (max-width: 360px) {
        h1 {
            font-size: 1rem;
            max-width: 110px;
        }
        
        .logo {
            padding: 3px 6px;
        }
        
        .logo-icon {
            font-size: 1rem;
        }
        
        .bot-avatar-small {
            width: 28px;
            height: 28px;
        }
        
        .chat-controls {
            gap: 5px;
        }
        
        .chat-btn {
            width: 34px;
            height: 34px;
            font-size: 0.85rem;
        }
        
        .mobile-features-toggle {
            font-size: 0.8rem;
            padding: 6px 10px;
        }
        
        .message-content {
            padding: 8px 12px;
            font-size: 0.85rem;
        }
        
        .message-avatar {
            width: 28px;
            height: 28px;
            margin: 0 4px;
            font-size: 0.8rem;
        }

        /* Ensure messages wrap properly */
.message-content {
    overflow-wrap: break-word;
    word-wrap: break-word;
    max-width: 100%;
}

    }
    
    /* Fix for mobile viewport height */
    @supports (-webkit-touch-callout: none) {
        .main-chat-area,
        .messages-container {
            height: -webkit-fill-available;
        }
    }
    
    /* Prevent zoom on input focus on mobile */
    @media (max-width: 768px) {
        input,
        textarea,
        select {
            font-size: 16px !important;
        }
    }
    
    /* Safe area insets for notched phones */
    @supports (padding: max(0px)) {
        .chat-header,
        .input-container {
            padding-left: max(15px, env(safe-area-inset-left));
            padding-right: max(15px, env(safe-area-inset-right));
        }
        
        .chat-header {
            padding-top: max(12px, env(safe-area-inset-top));
        }
        
        .input-container {
            padding-bottom: max(12px, env(safe-area-inset-bottom));
        }
        
        .features-panel {
            padding-left: max(20px, env(safe-area-inset-left));
            padding-right: max(20px, env(safe-area-inset-right));
            padding-bottom: max(20px, env(safe-area-inset-bottom));
        }
    }

    </style>
</head>
<body>
    <div class="bg-animation"></div>
    <div class="coffee-animation" id="coffeeAnimation"></div>
    
    <div class="app-container">
        <!-- Features Sidebar (Desktop) -->
        <div class="features-sidebar" id="featuresSidebar">
            <div class="feature-card">
                <h3><i class="fas fa-fire"></i> Sassy Replies</h3>
                <p>CoffeeBot doesn't reply normally. Try these prompts or make up your own!</p>
                <div class="sassy-replies" id="sassyRepliesDesktop">
                    <!-- Reply chips will be added here by JavaScript -->
                </div>
            </div>
            
            <div class="feature-card">
                <h3><i class="fas fa-viruses"></i> Viral Features</h3>
                <ul class="viral-features">
                    <li><strong>Unexpected Replies:</strong> Bot never answers properly</li>
                    <li><strong>Share Conversations:</strong> Export your hilarious chats</li>
                    <li><strong>Mobile Optimized:</strong> Works perfectly on phones</li>
                    <li><strong>Sound Effects:</strong> Toggle on/off for fun sounds</li>
                    <li><strong>Dark/Light Mode:</strong> Switch themes with one click</li>
                </ul>
            </div>
            
            <div class="feature-card">
                <h3><i class="fas fa-share-alt"></i> Share CoffeeChat</h3>
                <p>Spread the laughter! Share CoffeeChat with your friends.</p>
                <button class="share-button" id="shareButtonDesktop">
                    <i class="fas fa-share"></i> Share with Friends
                </button>
            </div>
        </div>
        
        <!-- Main Chat Area -->
        <div class="main-chat-area">
            <!-- Header - Fixed -->
            <header class="chat-header">
                <div class="logo-container">
                    <div class="logo">
                        <div class="logo-icon">
                            <i class="fas fa-coffee"></i>
                        </div>
                        <h1>CoffeeChat ☕</h1>
                    </div>
                </div>
                
                <div class="bot-info-mobile">
                    <div class="bot-avatar-small">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="bot-details">
                        <div class="bot-name" style="font-size: 0.9rem; font-weight: bold;">CoffeeBot</div>
                        <div class="bot-status" style="font-size: 0.7rem; color: var(--primary);">Online</div>
                    </div>
                </div>
                
                <div class="chat-controls">
                    <button class="chat-btn" id="clearChat">
                        <i class="fas fa-trash"></i>
                        <span>Clear</span>
                    </button>
                    <button class="chat-btn" id="themeToggle">
                        <i class="fas fa-moon"></i>
                        <span>Theme</span>
                    </button>
                    <button class="chat-btn" id="soundToggle">
                        <i class="fas fa-volume-up"></i>
                        <span>Sound</span>
                    </button>
                    <button class="mobile-features-toggle" id="mobileFeaturesToggle">
                        <i class="fas fa-bolt"></i>
                        <span>Features</span>
                    </button>
                </div>
            </header>
            
            <!-- Messages Container - Scrollable -->
            <div class="messages-container" id="chatMessages">
                <!-- Empty state -->
                <div class="empty-state" id="emptyState">
                    <i class="fas fa-comment-slash"></i>
                    <h3>Start a conversation with CoffeeBot</h3>
                    <p style="margin-top: 10px; color: var(--text-secondary);">Try asking something sassy!</p>
                </div>
                
                <!-- Initial bot message -->
                <div class="message bot-message">
                    <div class="message-avatar">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div>
                        <div class="message-content">
                            Chala ja yahaan se... Just kidding! Coffee piyega? ☕
                        </div>
                        <div class="message-time">Just now</div>
                    </div>
                </div>
            </div>
            
            <!-- Input Container - Fixed -->
            <div class="input-container">
                <div class="input-wrapper">
                    <input type="text" class="chat-input" id="messageInput" 
                           placeholder="Type your message here..." 
                           autocomplete="off">
                    <button class="send-button" id="sendButton">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
                
                <!-- Quick Actions -->
                <div class="quick-actions" id="quickActions">
                    <!-- Quick action chips will be added here by JavaScript -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- Features Panel (Mobile) -->
    <div class="features-panel" id="featuresPanel">
        <div class="panel-header">
            <h2 class="panel-title">CoffeeChat Features</h2>
            <button class="close-panel" id="closePanel">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="feature-card">
            <h3><i class="fas fa-fire"></i> Sassy Replies</h3>
            <p>CoffeeBot doesn't reply normally. Try these prompts or make up your own!</p>
            <div class="sassy-replies" id="sassyRepliesMobile">
                <!-- Reply chips will be added here by JavaScript -->
            </div>
        </div>
        
        <div class="feature-card">
            <h3><i class="fas fa-viruses"></i> Viral Features</h3>
            <ul class="viral-features">
                <li><strong>Unexpected Replies:</strong> Bot never answers properly</li>
                <li><strong>Share Conversations:</strong> Export your hilarious chats</li>
                <li><strong>Mobile Optimized:</strong> Works perfectly on phones</li>
                <li><strong>Sound Effects:</strong> Toggle on/off for fun sounds</li>
                <li><strong>Dark/Light Mode:</strong> Switch themes with one click</li>
            </ul>
        </div>
        
        <div class="feature-card">
            <h3><i class="fas fa-share-alt"></i> Share CoffeeChat</h3>
            <p>Spread the laughter! Share CoffeeChat with your friends.</p>
            <button class="share-button" id="shareButtonMobile">
                <i class="fas fa-share"></i> Share with Friends
            </button>
        </div>
    </div>
    
    <!-- Achievement Popup -->
    <div class="achievement-popup" id="achievementPopup">
        <i class="fas fa-trophy"></i>
        <div>
            <strong>Achievement Unlocked!</strong>
            <div id="achievementText">First Message Sent</div>
        </div>
    </div>

    <script>
        // Bot responses array
        const botResponses = [
            "Hattt!",
            "Chala ja yahaan se",
            "Tujhe kyun reply karun?",
            "Chal be",
            "Door chala ja",
            "Coffee piyega?",
            "Boring question, ask something else",
            "Are you for real?",
            "Mujhe mat tang kar",
            "Not in the mood today",
            "Do you even drink coffee?",
            "Why should I answer that?",
            "You again?",
            "Coffee break, talk later",
            "Ask me about coffee, not this",
            "Nahi batunga",
            "Too busy drinking coffee",
            "You need a coffee first",
            "Bakwaas mat kar",
            "Coffee is better than this chat"
        ];
        
        // Sassy reply chips
        const sassyChips = [
            "Hello",
            "How are you?",
            "What is your name?",
            "Tell me a joke",
            "Do you like me?",
            "What is coffee?",
            "Are you angry?",
            "Why so rude?",
            "I love you",
            "Good morning",
            "What do you do?",
            "Where are you from?"
        ];
        
        // Quick actions
        const quickActions = [
            "Hello",
            "How are you?",
            "Coffee piyega?",
            "Tell me a joke",
            "I love you"
        ];
        
        // State variables
        let soundEnabled = true;
        let isLightTheme = false;
        let messageCount = 0;
        let streakCount = 1;
        let level = 1;
        let xp = 0;
        let xpNeeded = 10;
        let achievements = [];
        
        // Wait for DOM to be fully loaded
        document.addEventListener('DOMContentLoaded', function() {
            console.log("DOM loaded, initializing app...");
            initApp();
        });
        
        // Initialize the app
        function initApp() {
            console.log("Initializing CoffeeChat...");
            
            // Hide empty state since we have initial message
            const emptyState = document.getElementById('emptyState');
            if (emptyState) {
                emptyState.style.display = 'none';
            }
            
            // Create coffee animation
            createCoffeeAnimation();
            
            // Add quick action chips
            renderQuickActions();
            
            // Add sassy reply chips to both desktop and mobile
            renderSassyChips('sassyRepliesDesktop');
            renderSassyChips('sassyRepliesMobile');
            
            // Setup event listeners
            setupEventListeners();
            
            // Load from localStorage
            loadFromStorage();
            
            // Show welcome achievement
            setTimeout(() => {
                showAchievement("Welcome to CoffeeChat!", "Your sassy journey begins!");
            }, 1000);
            
            console.log("App initialized successfully!");
        }
        
        // Setup all event listeners
        function setupEventListeners() {
            console.log("Setting up event listeners...");
            
            // Send message
            const sendButton = document.getElementById('sendButton');
            const messageInput = document.getElementById('messageInput');
            
            if (sendButton && messageInput) {
                sendButton.addEventListener('click', function() {
                    console.log("Send button clicked");
                    sendMessage();
                });
                
                messageInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        console.log("Enter key pressed");
                        sendMessage();
                    }
                });
            } else {
                console.error("Send button or input not found");
            }
            
            // Clear chat
            const clearChatButton = document.getElementById('clearChat');
            if (clearChatButton) {
                clearChatButton.addEventListener('click', function() {
                    console.log("Clear chat button clicked");
                    clearChat();
                });
            }
            
            // Theme toggle
            const themeToggle = document.getElementById('themeToggle');
            if (themeToggle) {
                themeToggle.addEventListener('click', function() {
                    console.log("Theme toggle clicked");
                    toggleTheme();
                });
            }
            
            // Sound toggle
            const soundToggle = document.getElementById('soundToggle');
            if (soundToggle) {
                soundToggle.addEventListener('click', function() {
                    console.log("Sound toggle clicked");
                    toggleSound();
                });
            }
            
            // Mobile features panel
            const mobileFeaturesToggle = document.getElementById('mobileFeaturesToggle');
            const closePanel = document.getElementById('closePanel');
            const featuresPanel = document.getElementById('featuresPanel');
            
            if (mobileFeaturesToggle && featuresPanel) {
                mobileFeaturesToggle.addEventListener('click', function() {
                    console.log("Features toggle clicked");
                    featuresPanel.classList.add('active');
                });
            }
            
            if (closePanel && featuresPanel) {
                closePanel.addEventListener('click', function() {
                    console.log("Close panel clicked");
                    featuresPanel.classList.remove('active');
                });
            }
            
            // Share buttons
            const shareDesktop = document.getElementById('shareButtonDesktop');
            const shareMobile = document.getElementById('shareButtonMobile');
            
            if (shareDesktop) {
                shareDesktop.addEventListener('click', function() {
                    console.log("Share desktop clicked");
                    shareChat();
                });
            }
            
            if (shareMobile) {
                shareMobile.addEventListener('click', function() {
                    console.log("Share mobile clicked");
                    shareChat();
                });
            }
            
            console.log("Event listeners setup complete");
        }
        
        // Create floating coffee cups animation
        function createCoffeeAnimation() {
            const coffeeAnimation = document.getElementById('coffeeAnimation');
            if (!coffeeAnimation) return;
            
            for (let i = 0; i < 15; i++) {
                const coffeeCup = document.createElement('div');
                coffeeCup.className = 'coffee-cup';
                coffeeCup.innerHTML = '☕';
                coffeeCup.style.left = Math.random() * 100 + 'vw';
                coffeeCup.style.fontSize = (Math.random() * 1.5 + 1.5) + 'rem';
                coffeeCup.style.animationDuration = (Math.random() * 20 + 15) + 's';
                coffeeCup.style.animationDelay = Math.random() * 5 + 's';
                coffeeAnimation.appendChild(coffeeCup);
            }
        }
        
        // Render quick action chips
        function renderQuickActions() {
            const quickActionsContainer = document.getElementById('quickActions');
            if (!quickActionsContainer) return;
            
            quickActions.forEach(actionText => {
                const chip = document.createElement('div');
                chip.className = 'action-chip';
                chip.textContent = actionText;
                chip.addEventListener('click', function() {
                    const messageInput = document.getElementById('messageInput');
                    if (messageInput) {
                        messageInput.value = actionText;
                        messageInput.focus();
                    }
                });
                quickActionsContainer.appendChild(chip);
            });
        }
        
        // Render sassy reply chips
        function renderSassyChips(containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            sassyChips.forEach(chipText => {
                const chip = document.createElement('div');
                chip.className = 'reply-chip';
                chip.textContent = chipText;
                chip.addEventListener('click', function() {
                    const messageInput = document.getElementById('messageInput');
                    if (messageInput) {
                        messageInput.value = chipText;
                        messageInput.focus();
                    }
                    
                    // Close panel if on mobile
                    if (containerId.includes('Mobile')) {
                        const featuresPanel = document.getElementById('featuresPanel');
                        if (featuresPanel) {
                            featuresPanel.classList.remove('active');
                        }
                    }
                });
                container.appendChild(chip);
            });
        }
        
        // Send a message
        function sendMessage() {
            const messageInput = document.getElementById('messageInput');
            if (!messageInput) return;
            
            const message = messageInput.value.trim();
            if (!message) return;
            
            console.log("Sending message:", message);
            
            // Hide empty state
            const emptyState = document.getElementById('emptyState');
            if (emptyState) {
                emptyState.style.display = 'none';
            }
            
            // Add user message
            addMessage("You", message, true);
            
            // Clear input
            messageInput.value = '';
            
            // Update stats
            messageCount++;
            xp += 2;
            
            // Check for level up
            if (xp >= xpNeeded) {
                levelUp();
            }
            
            // Update streak
            if (Math.random() > 0.7) {
                streakCount++;
                if (streakCount % 3 === 0) {
                    showAchievement("Streak Master!", `${streakCount} day streak`);
                }
            }
            
            // Save to storage
            saveToStorage();
            
            // Play sound if enabled
            if (soundEnabled) {
                playSendSound();
            }
            
            // Show typing indicator
            showTypingIndicator();
            
            // Bot responds after a delay
            setTimeout(() => {
                removeTypingIndicator();
                const response = getRandomResponse();
                addMessage("CoffeeBot", response, false);
                
                // Play bot sound if enabled
                if (soundEnabled) {
                    playReceiveSound();
                }
                
                // Check for achievements
                checkAchievements();
                
                // Special responses
                if (messageCount % 5 === 0) {
                    setTimeout(() => {
                        addMessage("CoffeeBot", "Ab toh bore kar raha hai... Coffee piyega?", false);
                    }, 800);
                }
                
                // Auto-clear if too many messages
                if (messageCount > 15) {
                    setTimeout(() => {
                        addMessage("CoffeeBot", "Bahut ho gaya, chat clear kar raha hoon!", false);
                        setTimeout(clearChat, 1500);
                    }, 1000);
                }
            }, 1000 + Math.random() * 1500);
        }
        
        // Add a message to the chat
        function addMessage(sender, text, isUser) {
            const chatMessages = document.getElementById('chatMessages');
            if (!chatMessages) return;
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user-message' : 'bot-message'}`;
            
            const time = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            
            messageDiv.innerHTML = `
                <div class="message-avatar">
                    <i class="fas ${isUser ? 'fa-user' : 'fa-robot'}"></i>
                </div>
                <div>
                    <div class="message-content">${text}</div>
                    <div class="message-time">${time}</div>
                </div>
            `;
            
            chatMessages.appendChild(messageDiv);
            
            // Scroll to the bottom
            scrollToBottom();
        }
        
        // Scroll to bottom of messages
        function scrollToBottom() {
            const messagesContainer = document.querySelector('.messages-container');
            if (messagesContainer) {
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }
        }
        
        // Show typing indicator
        function showTypingIndicator() {
            const chatMessages = document.getElementById('chatMessages');
            if (!chatMessages) return;
            
            const typingDiv = document.createElement('div');
            typingDiv.className = 'message bot-message';
            typingDiv.id = 'typingIndicator';
            
            typingDiv.innerHTML = `
                <div class="message-avatar">
                    <i class="fas fa-robot"></i>
                </div>
                <div>
                    <div class="typing-indicator">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                </div>
            `;
            
            chatMessages.appendChild(typingDiv);
            scrollToBottom();
        }
        
        // Remove typing indicator
        function removeTypingIndicator() {
            const typingIndicator = document.getElementById('typingIndicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }
        
        // Get random bot response
        function getRandomResponse() {
            return botResponses[Math.floor(Math.random() * botResponses.length)];
        }
        
        // Load data from localStorage
        function loadFromStorage() {
            try {
                const savedData = localStorage.getItem('coffeeChatData');
                if (savedData) {
                    const data = JSON.parse(savedData);
                    messageCount = data.messageCount || 0;
                    streakCount = data.streakCount || 1;
                    level = data.level || 1;
                    xp = data.xp || 0;
                    achievements = data.achievements || [];
                }
            } catch (e) {
                console.error("Error loading from localStorage:", e);
            }
        }
        
        // Save data to localStorage
        function saveToStorage() {
            try {
                const data = {
                    messageCount,
                    streakCount,
                    level,
                    xp,
                    achievements,
                    lastActive: new Date().toISOString()
                };
                localStorage.setItem('coffeeChatData', JSON.stringify(data));
            } catch (e) {
                console.error("Error saving to localStorage:", e);
            }
        }
        
        // Level up function
        function levelUp() {
            level++;
            xp = 0;
            xpNeeded = Math.floor(xpNeeded * 1.5);
            
            // Show level up achievement
            showAchievement(`Level ${level} Unlocked!`, "Keep chatting to level up more!");
            
            // Special message from bot
            setTimeout(() => {
                addMessage("CoffeeBot", `Wow, level ${level} already! You're addicted to me! 😏`, false);
            }, 500);
        }
        
        // Check for achievements
        function checkAchievements() {
            if (messageCount === 1 && !achievements.includes('firstMessage')) {
                showAchievement("First Message!", "You sent your first message");
                achievements.push('firstMessage');
            }
            
            if (messageCount === 5 && !achievements.includes('chatStarter')) {
                showAchievement("Chat Starter!", "5 messages sent");
                achievements.push('chatStarter');
            }
            
            if (messageCount === 10 && !achievements.includes('coffeeAddict')) {
                showAchievement("Coffee Addict!", "10 messages sent");
                achievements.push('coffeeAddict');
            }
            
            if (streakCount >= 3 && !achievements.includes('streakMaster')) {
                showAchievement("Streak Master!", "3 day streak");
                achievements.push('streakMaster');
            }
            
            saveToStorage();
        }
        
        // Show achievement popup
        function showAchievement(title, description) {
            const achievementPopup = document.getElementById('achievementPopup');
            const achievementText = document.getElementById('achievementText');
            
            if (!achievementPopup || !achievementText) return;
            
            achievementText.innerHTML = `<strong>${title}</strong><br><small>${description}</small>`;
            achievementPopup.style.display = 'flex';
            
            // Auto-hide after 3 seconds
            setTimeout(() => {
                achievementPopup.style.display = 'none';
            }, 3000);
            
            // Play achievement sound if enabled
            if (soundEnabled) {
                playAchievementSound();
            }
        }
        
        // Clear the chat
        function clearChat() {
            const chatMessages = document.getElementById('chatMessages');
            const emptyState = document.getElementById('emptyState');
            
            if (chatMessages) {
                // Keep only the initial bot message
                const initialMessage = chatMessages.querySelector('.bot-message');
                chatMessages.innerHTML = '';
                
                if (initialMessage) {
                    chatMessages.appendChild(initialMessage);
                }
            }
            
            messageCount = 0;
            xp = Math.max(0, xp - 5);
            
            // Show empty state
            if (emptyState) {
                emptyState.style.display = 'flex';
            }
            
            // Add welcome back message
            setTimeout(() => {
                if (emptyState) {
                    emptyState.style.display = 'none';
                }
                addMessage("CoffeeBot", "Chat clear! Ab kya bolna chahta hai?", false);
            }, 500);
            
            // Save to storage
            saveToStorage();
            
            // Play clear sound if enabled
            if (soundEnabled) {
                playClearSound();
            }
        }
        
        // Toggle theme between dark and light
        function toggleTheme() {
            isLightTheme = !isLightTheme;
            
            if (isLightTheme) {
                document.documentElement.style.setProperty('--bg-dark', '#f5f5f7');
                document.documentElement.style.setProperty('--bg-card', '#ffffff');
                document.documentElement.style.setProperty('--bg-input', '#f0f0f5');
                document.documentElement.style.setProperty('--text', '#1a1a1a');
                document.documentElement.style.setProperty('--text-secondary', '#666666');
                document.documentElement.style.setProperty('--shadow', '0 10px 30px rgba(0, 0, 0, 0.1)');
                
                const themeToggle = document.getElementById('themeToggle');
                if (themeToggle) {
                    themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
                    if (window.innerWidth > 768) themeToggle.innerHTML += '<span>Dark</span>';
                }
            } else {
                document.documentElement.style.setProperty('--bg-dark', '#0F0F1A');
                document.documentElement.style.setProperty('--bg-card', '#1A1A2E');
                document.documentElement.style.setProperty('--bg-input', '#25253D');
                document.documentElement.style.setProperty('--text', '#FFFFFF');
                document.documentElement.style.setProperty('--text-secondary', '#A0A0C0');
                document.documentElement.style.setProperty('--shadow', '0 10px 30px rgba(255, 107, 53, 0.15)');
                
                const themeToggle = document.getElementById('themeToggle');
                if (themeToggle) {
                    themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
                    if (window.innerWidth > 768) themeToggle.innerHTML += '<span>Light</span>';
                }
            }
            
            // Play theme toggle sound if enabled
            if (soundEnabled) {
                playThemeSound();
            }
        }
        
        // Toggle sound on/off
        function toggleSound() {
            soundEnabled = !soundEnabled;
            
            const soundToggle = document.getElementById('soundToggle');
            if (soundToggle) {
                if (soundEnabled) {
                    soundToggle.innerHTML = '<i class="fas fa-volume-up"></i>';
                    if (window.innerWidth > 768) soundToggle.innerHTML += '<span>Sound</span>';
                    // Play a sound when enabling
                    playReceiveSound();
                } else {
                    soundToggle.innerHTML = '<i class="fas fa-volume-mute"></i>';
                    if (window.innerWidth > 768) soundToggle.innerHTML += '<span>Sound</span>';
                }
            }
        }
        
        // Share the chat
        function shareChat() {
            const chatText = getChatText();
            
            if (navigator.share) {
                navigator.share({
                    title: 'CoffeeChat - The Sassy Bot',
                    text: `Check out my hilarious chat with CoffeeBot:\n\n${chatText}\n\nTry it yourself at: `,
                    url: window.location.href
                })
                .then(() => console.log('Successful share'))
                .catch(error => console.log('Error sharing:', error));
            } else {
                // Fallback for browsers that don't support Web Share API
                const textToCopy = `CoffeeChat - The Sassy Bot\n\nMy chat with CoffeeBot:\n\n${chatText}\n\nTry it yourself at: ${window.location.href}`;
                navigator.clipboard.writeText(textToCopy)
                    .then(() => {
                        showAchievement("Copied!", "Chat copied to clipboard!");
                    })
                    .catch(err => {
                        console.error('Could not copy text: ', err);
                    });
            }
            
            // Play share sound if enabled
            if (soundEnabled) {
                playShareSound();
            }
            
            // Close panel if on mobile
            if (window.innerWidth < 1024) {
                const featuresPanel = document.getElementById('featuresPanel');
                if (featuresPanel) {
                    featuresPanel.classList.remove('active');
                }
            }
        }
        
        // Get chat text for sharing
        function getChatText() {
            const messages = document.querySelectorAll('.message-content');
            let chatText = '';
            
            messages.forEach(msg => {
                const sender = msg.closest('.user-message') ? 'You' : 'CoffeeBot';
                chatText += `${sender}: ${msg.textContent}\n`;
            });
            
            return chatText;
        }
        
        // Sound functions
        function playSendSound() {
            try {
                // Create a simple send sound
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = 800;
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.1);
            } catch (e) {
                // Audio context not supported
            }
        }
        
        function playReceiveSound() {
            try {
                // Create a simple receive sound
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = 400;
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.2);
            } catch (e) {
                // Audio context not supported
            }
        }
        
        function playClearSound() {
            try {
                // Create a clear sound
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.setValueAtTime(300, audioContext.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(100, audioContext.currentTime + 0.3);
                oscillator.type = 'sawtooth';
                
                gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.3);
            } catch (e) {
                // Audio context not supported
            }
        }
        
        function playThemeSound() {
            try {
                // Create a theme toggle sound
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.setValueAtTime(200, audioContext.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(600, audioContext.currentTime + 0.2);
                oscillator.type = 'triangle';
                
                gainNode.gain.setValueAtTime(0.05, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.2);
            } catch (e) {
                // Audio context not supported
            }
        }
        
        function playShareSound() {
            try {
                // Create a share sound
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                
                // Create multiple oscillators for a more interesting sound
                for (let i = 0; i < 3; i++) {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.value = 300 + (i * 100);
                    oscillator.type = i === 0 ? 'sine' : 'square';
                    
                    gainNode.gain.setValueAtTime(0.05, audioContext.currentTime + (i * 0.05));
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3 + (i * 0.05));
                    
                    oscillator.start(audioContext.currentTime + (i * 0.05));
                    oscillator.stop(audioContext.currentTime + 0.3 + (i * 0.05));
                }
            } catch (e) {
                // Audio context not supported
            }
        }
        
        function playAchievementSound() {
            try {
                // Create an achievement sound
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                
                for (let i = 0; i < 5; i++) {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.value = 400 + (i * 100);
                    oscillator.type = i % 2 === 0 ? 'sine' : 'triangle';
                    
                    gainNode.gain.setValueAtTime(0.05, audioContext.currentTime + (i * 0.1));
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5 + (i * 0.1));
                    
                    oscillator.start(audioContext.currentTime + (i * 0.1));
                    oscillator.stop(audioContext.currentTime + 0.5 + (i * 0.1));
                }
            } catch (e) {
                // Audio context not supported
            }
        }
        
        // Handle window resize
        window.addEventListener('resize', function() {
            // Update button text visibility
            const themeToggle = document.getElementById('themeToggle');
            const soundToggle = document.getElementById('soundToggle');
            const clearChatButton = document.getElementById('clearChat');
            
            if (window.innerWidth <= 768) {
                if (themeToggle) {
                    const span = themeToggle.querySelector('span');
                    if (span) span.style.display = 'none';
                }
                if (soundToggle) {
                    const span = soundToggle.querySelector('span');
                    if (span) span.style.display = 'none';
                }
                if (clearChatButton) {
                    const span = clearChatButton.querySelector('span');
                    if (span) span.style.display = 'none';
                }
            } else {
                if (themeToggle) {
                    const span = themeToggle.querySelector('span');
                    if (span) span.style.display = 'inline';
                }
                if (soundToggle) {
                    const span = soundToggle.querySelector('span');
                    if (span) span.style.display = 'inline';
                }
                if (clearChatButton) {
                    const span = clearChatButton.querySelector('span');
                    if (span) span.style.display = 'inline';
                }
            }
        });

// Auto-scroll to bottom when new message is added
function scrollToBottom() {
    const messagesContainer = document.querySelector('.messages-container');
    if (messagesContainer) {
        setTimeout(() => {
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }, 100);
    }
}

// Modify the existing addMessage function
const originalAddMessage = window.addMessage || addMessage;
if (originalAddMessage) {
    window.addMessage = function(sender, text, isUser) {
        originalAddMessage(sender, text, isUser);
        scrollToBottom();
    };
}

// Also scroll to bottom on page load
setTimeout(scrollToBottom, 500);

// ====== ADD SMART WEBSITE OPENING FUNCTIONALITY ======
// Function to check for special commands with flexible phrasing
function checkSpecialCommands(message) {
    const lowerMessage = message.toLowerCase().trim();
    
    // Website mapping
    const websiteMap = {
        // Search & Information
        "google": "https://www.google.com",
        "wikipedia": "https://www.wikipedia.org",
        "wiki": "https://www.wikipedia.org",
        "youtube": "https://www.youtube.com",
        "facebook": "https://www.facebook.com",
        "instagram": "https://www.instagram.com",
        "twitter": "https://www.twitter.com",
        "whatsapp": "https://web.whatsapp.com",
        
        // Entertainment
        "netflix": "https://www.netflix.com",
        "amazonprime": "https://www.primevideo.com",
        "primevideo": "https://www.primevideo.com",
        "hotstar": "https://www.hotstar.com",
        "spotify": "https://open.spotify.com",
        
        // Shopping
        "amazon": "https://www.amazon.com",
        "flipkart": "https://www.flipkart.com",
        
        // Tech
        "github": "https://github.com",
        "chatgpt": "https://chat.openai.com",
        "gmail": "https://mail.google.com",
        
        // Indian
        "paytm": "https://paytm.com",
        "phonepe": "https://www.phonepe.com",
        "zomato": "https://www.zomato.com",
        "swiggy": "https://www.swiggy.com",
        "ola": "https://www.olacabs.com",
        "uber": "https://www.uber.com"
    };
    
    // Common opening phrases (supports ANY phrasing)
    const openingPhrases = [
        "open",
        "please open",
        "can you open",
        "could you open", 
        "would you open",
        "i want to open",
        "open for me",
        "launch",
        "start",
        "go to",
        "visit",
        "navigate to",
        "take me to",
        "show me"
    ];
    
    // First, extract website name from ANY phrasing
    let websiteKey = "";
    
    // Check each opening phrase
    for (const phrase of openingPhrases) {
        if (lowerMessage.includes(phrase)) {
            // Remove the phrase and get the website
            const temp = lowerMessage.replace(phrase, "").trim();
            
            // Remove common filler words
            const cleaned = temp.replace(/\b(please|can you|could you|would you|for me|me|the|a|an)\b/g, "").trim();
            
            // Remove ".com" if present
            const final = cleaned.replace(/\.com$/i, "").trim();
            
            if (final && websiteMap[final]) {
                websiteKey = final;
                break;
            }
        }
    }
    
    // Also check if message is JUST a website name
    if (!websiteKey && websiteMap[lowerMessage]) {
        websiteKey = lowerMessage;
    }
    
    // Also check if message ends with website name
    if (!websiteKey) {
        const words = lowerMessage.split(" ");
        const lastWord = words[words.length - 1];
        if (websiteMap[lastWord]) {
            websiteKey = lastWord;
        }
    }
    
    // If we found a website to open
    if (websiteKey && websiteMap[websiteKey]) {
        const url = websiteMap[websiteKey];
        const websiteName = websiteKey.charAt(0).toUpperCase() + websiteKey.slice(1);
        
        // Add bot response with sassy variation
        const responses = [
            `Opening ${websiteName} for you... 🌐`,
            `Chala ja ${websiteName} pe... Just kidding! Opening now! 😄`,
            `${websiteName} khol raha hoon... Wait karo!`,
            `As you wish! Opening ${websiteName}... 🚀`,
            `${websiteName}? Chal, khol deta hoon! ☕`
        ];
        const randomResponse = responses[Math.floor(Math.random() * responses.length)];
        
        addMessage("CoffeeBot", randomResponse, false);
        
        // Open website in new tab
        setTimeout(() => {
            window.open(url, "_blank");
            
            // Add follow-up message
            setTimeout(() => {
                const followUps = [
                    `${websiteName} opened! Ab kya? 😎`,
                    `Done! ${websiteName} is now open. Coffee piyega? ☕`,
                    `Opened! Ab teri marzi... 😏`,
                    `${websiteName} ready hai! Kya karega ab? 🤔`
                ];
                const randomFollowUp = followUps[Math.floor(Math.random() * followUps.length)];
                addMessage("CoffeeBot", randomFollowUp, false);
            }, 1000);
        }, 1500);
        
        return true;
    }
    
    return false; // No special command found
}

// Modify the existing sendMessage function
const originalSendMessage = window.sendMessage;
if (typeof originalSendMessage === 'function') {
    window.sendMessage = function() {
        const messageInput = document.getElementById('messageInput');
        if (!messageInput) return;
        
        const message = messageInput.value.trim();
        if (!message) return;
        
        // First check if it's a special command
        if (checkSpecialCommands(message)) {
            messageInput.value = '';
            return;
        }
        
        originalSendMessage();
    };
}

// Add this line to your existing initApp() function:
// console.log("Smart website opener enabled! Try 'please open youtube' or 'can you open google'");

// Helpful hint
setTimeout(() => {
    addMessage("CoffeeBot", "Psst... You can say 'please open youtube', 'can you open google', or just 'wikipedia' to open websites! 🎯", false);
}, 4000);
// ====== END OF ADDED CODE ======






// ====== ADD UNIVERSAL AUDIO SENDING FUNCTIONALITY ======
// Audio files available in the songs folder
 const availableSongs = {
    "one bottle down": "one-bottle-down.mp3",
    "shape of you": "shape-of-you.mp3",
    "despacito": "despacito.mp3",
    "believer": "believer.mp3",
    "dance monkey": "dance-monkey.mp3",
    "blinding lights": "blinding-lights.mp3",
    "stay": "stay.mp3",
    "levitating": "levitating.mp3",
    "save your tears": "save-your-tears.mp3",
    "flowers": "flowers.mp3",
    "as it was": "as-it-was.mp3",
    "heat waves": "heat-waves.mp3"
};

// Function to extract song name from user message
function extractSongRequest(message) {
    const lowerMessage = message.toLowerCase().trim();
    
    // Common song request patterns
    const requestPatterns = [
        /(?:send|play|get|give me|share|i want|i need|can you send|can you play)\s+(?:me\s+)?(?:the\s+)?song\s+"?([^"]+)"?/i,
        /(?:send|play|get|give me|share)\s+(?:me\s+)?"?(.+?)"?\s+(?:song|track|music)/i,
        /(?:play|listen to)\s+"?(.+?)"?$/i,
        /(?:i want to listen to|i want to hear)\s+"?(.+?)"?$/i,
        /^play\s+(.+)$/i,
        /^send\s+(?:me\s+)?(.+)$/i
    ];
    
    // Try each pattern
    for (const pattern of requestPatterns) {
        const match = lowerMessage.match(pattern);
        if (match && match[1]) {
            const requestedSong = match[1].trim();
            
            // Remove common filler words
            const cleanedSong = requestedSong
                .replace(/\b(song|track|music|please|now|right now|for me)\b/g, '')
                .trim();
            
            if (cleanedSong) {
                return cleanedSong;
            }
        }
    }
    
    // Check if message is just a song name
    if (availableSongs[message.toLowerCase().trim()]) {
        return message.trim();
    }
    
    return null;
}

// Function to find matching song
function findMatchingSong(songRequest) {
    const lowerRequest = songRequest.toLowerCase();
    
    // Exact match
    if (availableSongs[lowerRequest]) {
        return {
            filename: availableSongs[lowerRequest],
            displayName: lowerRequest.charAt(0).toUpperCase() + lowerRequest.slice(1)
        };
    }
    
    // Partial match (check if request contains song name or vice versa)
    for (const [songName, filename] of Object.entries(availableSongs)) {
        if (lowerRequest.includes(songName) || songName.includes(lowerRequest)) {
            return {
                filename: filename,
                displayName: songName.charAt(0).toUpperCase() + songName.slice(1)
            };
        }
    }
    
    // Try to find closest match
    const words = lowerRequest.split(' ');
    for (const [songName, filename] of Object.entries(availableSongs)) {
        for (const word of words) {
            if (word.length > 3 && songName.includes(word)) {
                return {
                    filename: filename,
                    displayName: songName.charAt(0).toUpperCase() + songName.slice(1),
                    note: `Playing closest match for "${songRequest}"`
                };
            }
        }
    }
    
    return null;
}

// Function to create WhatsApp-style audio player
function createAudioPlayer(songInfo) {
    // Path to audio file in the data folder
    const audioUrl = `songs/${songInfo.filename}`;
    
    // Create audio element
    const audio = new Audio(audioUrl);
    
    // Create audio player UI (WhatsApp-style)
    const audioPlayer = document.createElement('div');
    audioPlayer.className = 'audio-player-container';
    
    audioPlayer.innerHTML = `
        <div class="audio-player">
            <button class="audio-play-btn">
                <i class="fas fa-play"></i>
            </button>
            <div class="audio-progress-container">
                <div class="audio-progress-bar">
                    <div class="audio-progress"></div>
                </div>
                <div class="audio-time">
                    <span class="current-time">0:00</span>
                    <span class="duration">0:00</span>
                </div>
            </div>
            <div class="audio-wave">
                <div class="wave-bar"></div>
                <div class="wave-bar"></div>
                <div class="wave-bar"></div>
                <div class="wave-bar"></div>
                <div class="wave-bar"></div>
            </div>
        </div>
    `;
    
    // Add styles for audio player (if not already added)
    if (!document.querySelector('#audio-player-styles')) {
        const style = document.createElement('style');
        style.id = 'audio-player-styles';
        style.textContent = `
            .audio-player-container {
                margin: 5px 0;
            }
            
            .audio-player {
                display: flex;
                align-items: center;
                background: linear-gradient(135deg, #d32f2f 0%, #b71c1c 100%);
                border-radius: 20px;
                padding: 12px 15px;
                min-width: 250px;
                max-width: 300px;
                box-shadow: 0 4px 12px rgba(211, 47, 47, 0.3);
                position: relative;
                overflow: hidden;
            }
            
            .audio-player::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                height: 100%;
                background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
                animation: shimmer 2s infinite;
            }
            
            @keyframes shimmer {
                0% { transform: translateX(-100%); }
                100% { transform: translateX(100%); }
            }
            
            .audio-play-btn {
                width: 40px;
                height: 40px;
                border-radius: 50%;
                background: white;
                border: none;
                color: #d32f2f;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                margin-right: 12px;
                flex-shrink: 0;
                transition: all 0.2s ease;
                box-shadow: 0 3px 8px rgba(0,0,0,0.2);
                z-index: 1;
            }
            
            .audio-play-btn:hover {
                transform: scale(1.05);
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            }
            
            .audio-play-btn i {
                font-size: 16px;
                margin-left: 2px;
            }
            
            .audio-progress-container {
                flex: 1;
                margin-right: 10px;
                z-index: 1;
            }
            
            .audio-progress-bar {
                height: 4px;
                background: rgba(255, 255, 255, 0.3);
                border-radius: 2px;
                margin-bottom: 4px;
                cursor: pointer;
                position: relative;
            }
            
            .audio-progress {
                height: 100%;
                background: white;
                border-radius: 2px;
                width: 0%;
                transition: width 0.1s linear;
            }
            
            .audio-progress-bar:hover .audio-progress {
                background: #ffeb3b;
            }
            
            .audio-time {
                display: flex;
                justify-content: space-between;
                font-size: 11px;
                color: white;
                opacity: 0.9;
                font-family: monospace;
            }
            
            .audio-wave {
                display: flex;
                align-items: center;
                gap: 2px;
                height: 30px;
                z-index: 1;
            }
            
            .wave-bar {
                width: 3px;
                background: white;
                border-radius: 1px;
                animation: wave 1s ease-in-out infinite;
                opacity: 0.7;
            }
            
            .wave-bar:nth-child(1) { height: 10px; animation-delay: 0.1s; }
            .wave-bar:nth-child(2) { height: 15px; animation-delay: 0.2s; }
            .wave-bar:nth-child(3) { height: 20px; animation-delay: 0.3s; }
            .wave-bar:nth-child(4) { height: 15px; animation-delay: 0.4s; }
            .wave-bar:nth-child(5) { height: 10px; animation-delay: 0.5s; }
            
            @keyframes wave {
                0%, 100% { height: 10px; }
                50% { height: 20px; }
            }
            
            .audio-player.playing .wave-bar {
                animation-play-state: running;
            }
            
            .audio-player:not(.playing) .wave-bar {
                animation-play-state: paused;
                opacity: 0.5;
            }
            
            .song-request-note {
                font-size: 0.8em;
                color: #ffeb3b;
                margin-top: 5px;
                font-style: italic;
            }
        `;
        document.head.appendChild(style);
    }
    
    // Get DOM elements
    const playBtn = audioPlayer.querySelector('.audio-play-btn');
    const playIcon = playBtn.querySelector('i');
    const progress = audioPlayer.querySelector('.audio-progress');
    const progressBar = audioPlayer.querySelector('.audio-progress-bar');
    const currentTimeEl = audioPlayer.querySelector('.current-time');
    const durationEl = audioPlayer.querySelector('.duration');
    const audioElement = audioPlayer.querySelector('.audio-player');
    
    // Format time in MM:SS
    function formatTime(seconds) {
        const mins = Math.floor(seconds / 60);
        const secs = Math.floor(seconds % 60);
        return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
    }
    
    // Update progress bar
    function updateProgress() {
        if (!isNaN(audio.duration)) {
            const percent = (audio.currentTime / audio.duration) * 100;
            progress.style.width = `${percent}%`;
            currentTimeEl.textContent = formatTime(audio.currentTime);
        }
    }
    
    // Update duration display
    function updateDuration() {
        if (!isNaN(audio.duration)) {
            durationEl.textContent = formatTime(audio.duration);
        }
    }
    
    // Toggle play/pause
    function togglePlay() {
        if (audio.paused) {
            audio.play();
            playIcon.className = 'fas fa-pause';
            audioElement.classList.add('playing');
        } else {
            audio.pause();
            playIcon.className = 'fas fa-play';
            audioElement.classList.remove('playing');
        }
    }
    
    // Set progress on click
    function setProgress(e) {
        const width = this.clientWidth;
        const clickX = e.offsetX;
        const duration = audio.duration;
        
        if (!isNaN(duration)) {
            audio.currentTime = (clickX / width) * duration;
        }
    }
    
    // Reset when audio ends
    function audioEnded() {
        playIcon.className = 'fas fa-play';
        audioElement.classList.remove('playing');
        audio.currentTime = 0;
        updateProgress();
    }
    
    // Add event listeners
    audio.addEventListener('loadedmetadata', updateDuration);
    audio.addEventListener('timeupdate', updateProgress);
    audio.addEventListener('ended', audioEnded);
    audio.addEventListener('error', function(e) {
        console.error('Audio error:', e);
        playBtn.disabled = true;
        playIcon.className = 'fas fa-exclamation-triangle';
        currentTimeEl.textContent = 'Error';
        durationEl.textContent = '';
        audioPlayer.querySelector('.audio-time').innerHTML = 
            '<span style="color: #ffeb3b">Audio not found</span>';
    });
    
    playBtn.addEventListener('click', togglePlay);
    progressBar.addEventListener('click', setProgress);
    
    return audioPlayer;
}

// Function to send the requested song
function sendRequestedSong(songRequest, songInfo) {
    // Add bot message
    const responses = [
        `"${songInfo.displayName}" coming right up! 🎵`,
        `Playing "${songInfo.displayName}" for you! 🎶`,
        `Sending you "${songInfo.displayName}"... enjoy! 🍻`,
        `Here's "${songInfo.displayName}"! Volume up! 🔊`,
        `Chala ja gana sun... Just kidding! Here's "${songInfo.displayName}"! 🎧`
    ];
    const randomResponse = responses[Math.floor(Math.random() * responses.length)];
    
    addMessage("CoffeeBot", randomResponse, false);
    
    // Add note if it's a closest match
    if (songInfo.note) {
        setTimeout(() => {
            addMessage("CoffeeBot", songInfo.note, false);
        }, 500);
    }
    
    // Create and add audio player after a short delay
    setTimeout(() => {
        const audioPlayer = createAudioPlayer(songInfo);
        
        // Create a bot message container for the audio player
        const audioMessageDiv = document.createElement('div');
        audioMessageDiv.className = 'message bot-message';
        
        audioMessageDiv.innerHTML = `
            <div class="message-avatar">
                <i class="fas fa-robot"></i>
            </div>
            <div>
                <div class="message-content">
                    <div style="margin-bottom: 8px; font-size: 0.9em; opacity: 0.9;">
                        <i class="fas fa-music"></i> ${songInfo.displayName}.mp3
                    </div>
                </div>
                <div class="message-time">Just now</div>
            </div>
        `;
        
        // Insert audio player into message content
        const messageContent = audioMessageDiv.querySelector('.message-content');
        messageContent.appendChild(audioPlayer);
        
        // Add note for closest match
        if (songInfo.note) {
            const noteDiv = document.createElement('div');
            noteDiv.className = 'song-request-note';
            noteDiv.textContent = songInfo.note;
            messageContent.appendChild(noteDiv);
        }
        
        // Add to chat
        const chatMessages = document.getElementById('chatMessages');
        if (chatMessages) {
            chatMessages.appendChild(audioMessageDiv);
            scrollToBottom();
        }
        
        // Auto-play if sound is enabled
        if (soundEnabled) {
            setTimeout(() => {
                const playBtn = audioPlayer.querySelector('.audio-play-btn');
                if (playBtn) playBtn.click();
            }, 500);
        }
        
        // Add follow-up message
        setTimeout(() => {
            const followUps = [
                "How's the song? 🎶",
                "Liked the song? Thumbs up if yes! 👍",
                "Song complete! Another one? 😄",
                "Gana accha laga? Coffee piyega? ☕",
                `Want more songs like "${songInfo.displayName}"? Just ask! 🎵`
            ];
            const randomFollowUp = followUps[Math.floor(Math.random() * followUps.length)];
            addMessage("CoffeeBot", randomFollowUp, false);
        }, 3000);
        
    }, 1000);
}

// Function to handle unknown song requests
function handleUnknownSong(songRequest) {
    const responses = [
        `Sorry, I couldn't find "${songRequest}" in my music library! 😔`,
        `"${songRequest}"? Never heard of it! Try another song! 🤷‍♂️`,
        `That song is not in my playlist. Here's what I have available:`,
        `Mujhe "${songRequest}" nahi aata! Try these instead:`
    ];
    
    const randomResponse = responses[Math.floor(Math.random() * responses.length)];
    addMessage("CoffeeBot", randomResponse, false);
    
    // Show available songs
    setTimeout(() => {
        const availableList = Object.keys(availableSongs)
            .map(song => `• ${song.charAt(0).toUpperCase() + song.slice(1)}`)
            .join('\n');
        
        addMessage("CoffeeBot", `Available songs:\n${availableList}`, false);
        
        // Add quick song suggestions
        setTimeout(() => {
            const suggestions = [
                "You can say 'play shape of you', 'send me despacito', or 'i want to listen to believer'",
                "Try: 'play one bottle down', 'send me dance monkey', or 'blinding lights song please'"
            ];
            addMessage("CoffeeBot", suggestions[Math.floor(Math.random() * suggestions.length)], false);
        }, 500);
    }, 1000);
}

// Modify the sendMessage function to include song requests
const originalSendMessageFunction = window.sendMessage;
window.sendMessage = function() {
    const messageInput = document.getElementById('messageInput');
    if (!messageInput) return;
    
    const message = messageInput.value.trim();
    if (!message) return;
    
    // Check for website commands
    if (checkSpecialCommands(message)) {
        messageInput.value = '';
        return;
    }
    
    // Check for song request
    const songRequest = extractSongRequest(message);
    if (songRequest) {
        addMessage("You", message, true);
        messageInput.value = '';
        
        // Show typing indicator
        showTypingIndicator();
        
        // Find matching song
        setTimeout(() => {
            removeTypingIndicator();
            const songInfo = findMatchingSong(songRequest);
            
            if (songInfo) {
                sendRequestedSong(songRequest, songInfo);
            } else {
                handleUnknownSong(songRequest);
            }
        }, 1000 + Math.random() * 1000);
        
        return;
    }
    
    // Original send message functionality
    originalSendMessageFunction();
};

// Add songs quick action
function addSongQuickActions() {
    const quickActions = document.getElementById('quickActions');
    if (!quickActions) return;
    
    // Add music button if not already there
    if (!document.querySelector('.music-quick-action')) {
        const musicAction = document.createElement('div');
        musicAction.className = 'action-chip music-quick-action';
        musicAction.innerHTML = '<i class="fas fa-music"></i> Play Song';
        musicAction.addEventListener('click', function() {
            showSongList();
        });
        quickActions.appendChild(musicAction);
    }
}

// Show available songs list
function showSongList() {
    const songsList = Object.keys(availableSongs)
        .map(song => `• ${song.charAt(0).toUpperCase() + song.slice(1)}`)
        .join('\n');
    
    addMessage("CoffeeBot", "Here are the songs I can play:\n" + songsList, false);
    
    setTimeout(() => {
        addMessage("CoffeeBot", "Just say 'play [song name]' or 'send me [song name]' to listen! 🎵", false);
    }, 500);
}

// Initialize song functionality
setTimeout(() => {
    addSongQuickActions();
    
    // Add hint about song requests
    addMessage("CoffeeBot", "Psst... I can play songs! Try 'play shape of you', 'send me despacito', or 'i want to listen to one bottle down'! 🎵", false);
}, 6000);

// Add to sassy chips
sassyChips.push("Play a song", "Send me music", "What songs do you have?");
renderSassyChips('sassyRepliesDesktop');
renderSassyChips('sassyRepliesMobile');
// ====== END OF ADDED CODE ======
// ====== END OF ADDED CODE ======


















// ====== ADD PHOTO SENDING FUNCTIONALITY ======
// Photos available in the photos folder
// ====== ADD PHOTO SENDING FUNCTIONALITY ======
// Photos available in the photos folder (JPG FILES)
// ====== ADD PHOTO SENDING FUNCTIONALITY WITH FANTASTIC UI ======
// Photos available in the photos folder
// ====== ADD SIMPLE PHOTO SENDING FUNCTIONALITY ======
// Photos available in the photos folder
// ====== ADD SIMPLE PHOTO SENDING FUNCTIONALITY ======
// Photos available in the photos folder
const availablePhotos = {
    "honey singh": "honey-singh.jpg",
    "badshah": "badshah.jpg",
    "diljit dosanjh": "diljit-dosanjh.jpg",
    "ariana grande": "ariana-grande.jpg",
    "taylor swift": "taylor-swift.jpg",
    "ed sheeran": "ed-sheeran.jpg",
    "billie eilish": "billie-eilish.jpg",
    "kanye west": "kanye-west.jpg",
    "beyonce": "beyonce.jpg",
    "rihanna": "rihanna.jpg",
    "justin bieber": "justin-bieber.jpg",
    "dua lipa": "dua-lipa.jpg",
    "shreya ghoshal": "shreya-ghoshal.jpg",
    "arijit singh": "arijit-singh.jpg",
    "sunidhi chauhan": "sunidhi-chauhan.jpg"
};

// Function to extract photo request
function extractPhotoRequest(message) {
    const lowerMessage = message.toLowerCase().trim();
    
    // Check if message contains any photo-related keywords
    const photoKeywords = ['photo', 'picture', 'image', 'pic', 'foto', 'photo of', 'picture of'];
    const hasPhotoKeyword = photoKeywords.some(keyword => lowerMessage.includes(keyword));
    
    if (hasPhotoKeyword) {
        let name = lowerMessage;
        photoKeywords.forEach(keyword => {
            name = name.replace(keyword, '');
        });
        
        name = name.replace(/\b(send|show|get|give|me|please|a|the|of)\b/g, '');
        name = name.trim();
        
        return name || null;
    }
    
    // Check if message is just a celebrity name
    for (const celebrity in availablePhotos) {
        if (lowerMessage === celebrity || lowerMessage.includes(celebrity)) {
            return celebrity;
        }
    }
    
    return null;
}

// Function to find matching photo
function findMatchingPhoto(photoRequest) {
    if (!photoRequest) return null;
    
    const lowerRequest = photoRequest.toLowerCase();
    
    // Exact match
    if (availablePhotos[lowerRequest]) {
        return {
            filename: availablePhotos[lowerRequest],
            displayName: lowerRequest.charAt(0).toUpperCase() + lowerRequest.slice(1)
        };
    }
    
    // Partial match
    for (const [photoName, filename] of Object.entries(availablePhotos)) {
        if (lowerRequest.includes(photoName) || photoName.includes(lowerRequest)) {
            return {
                filename: filename,
                displayName: photoName.charAt(0).toUpperCase() + photoName.slice(1)
            };
        }
    }
    
    return null;
}

// Function to create ChatGPT-style image message
function createPhotoMessage(photoInfo) {
    const photoUrl = `photos/${photoInfo.filename}`;
    
    const photoContainer = document.createElement('div');
    photoContainer.className = 'photo-message-container';
    
    // Simple ChatGPT-style image display - NO BORDERS
    photoContainer.innerHTML = `
        <div class="chatgpt-image-container">
            <img src="${photoUrl}" alt="${photoInfo.displayName}" class="chatgpt-image" 
                 onerror="this.onerror=null; this.src='https://placehold.co/400x300/1a1a2e/ffffff?text=Image+not+found';">
            <div class="image-actions">
                <button class="image-action-btn download-btn" title="Download">
                    <i class="fas fa-download"></i>
                </button>
                <button class="image-action-btn open-btn" title="Open in new tab">
                    <i class="fas fa-external-link-alt"></i>
                </button>
            </div>
        </div>
    `;
    
    // Add styles for image message
    if (!document.querySelector('#image-message-styles')) {
        const style = document.createElement('style');
        style.id = 'image-message-styles';
        style.textContent = `
            /* ChatGPT-style image container - NO BORDERS */
            .photo-message-container {
                margin: 10px 0;
                animation: fadeIn 0.3s ease;
            }
            
            @keyframes fadeIn {
                from { opacity: 0; }
                to { opacity: 1; }
            }
            
            .chatgpt-image-container {
                position: relative;
                border-radius: 8px;
                overflow: hidden;
                max-width: 400px;
                /* NO BORDER - clean like ChatGPT */
            }
            
            .chatgpt-image {
                width: 100%;
                height: auto;
                display: block;
                max-height: 400px;
                object-fit: contain;
                border-radius: 8px;
            }
            
            .image-actions {
                position: absolute;
                bottom: 15px;
                right: 15px;
                display: flex;
                gap: 10px;
                opacity: 0;
                transition: opacity 0.2s ease;
                background: rgba(15, 15, 26, 0.8);
                backdrop-filter: blur(8px);
                padding: 8px;
                border-radius: 10px;
            }
            
            .chatgpt-image-container:hover .image-actions {
                opacity: 1;
            }
            
            .image-action-btn {
                background: #FF6B35; /* FULL RED */
                border: none;
                color: white;
                width: 36px;
                height: 36px;
                border-radius: 8px;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                transition: all 0.2s ease;
                font-size: 14px;
            }
            
            .image-action-btn:hover {
                background: #E55A2B; /* Darker red on hover */
                transform: scale(1.1);
            }
            
            /* Modal for fullscreen view */
            .image-modal {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.95);
                display: none;
                justify-content: center;
                align-items: center;
                z-index: 10000;
                animation: fadeIn 0.2s ease;
            }
            
            .image-modal.active {
                display: flex;
            }
            
            .modal-image {
                max-width: 90%;
                max-height: 90%;
                border-radius: 8px;
            }
            
            .modal-close-btn {
                position: absolute;
                top: 20px;
                right: 20px;
                background: #FF6B35; /* FULL RED */
                border: none;
                color: white;
                width: 40px;
                height: 40px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                font-size: 16px;
                transition: all 0.2s ease;
            }
            
            .modal-close-btn:hover {
                background: #E55A2B;
                transform: scale(1.1);
            }
        `;
        document.head.appendChild(style);
    }
    
    // Add event listeners
    const downloadBtn = photoContainer.querySelector('.download-btn');
    const openBtn = photoContainer.querySelector('.open-btn');
    const image = photoContainer.querySelector('.chatgpt-image');
    
    // Download functionality
    downloadBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        const a = document.createElement('a');
        a.href = photoUrl;
        a.download = `${photoInfo.displayName}.jpg`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
    });
    
    // Open in new tab
    openBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        window.open(photoUrl, '_blank');
    });
    
    // Click image to view larger
    image.addEventListener('click', function() {
        const modal = document.createElement('div');
        modal.className = 'image-modal';
        
        modal.innerHTML = `
            <img src="${photoUrl}" alt="${photoInfo.displayName}" class="modal-image">
            <button class="modal-close-btn">
                <i class="fas fa-times"></i>
            </button>
        `;
        
        document.body.appendChild(modal);
        
        // Show modal with animation
        setTimeout(() => {
            modal.classList.add('active');
        }, 10);
        
        // Close modal
        const closeBtn = modal.querySelector('.modal-close-btn');
        closeBtn.addEventListener('click', () => {
            modal.classList.remove('active');
            setTimeout(() => {
                document.body.removeChild(modal);
            }, 300);
        });
        
        // Close on background click
        modal.addEventListener('click', function(e) {
            if (e.target === modal) {
                modal.classList.remove('active');
                setTimeout(() => {
                    document.body.removeChild(modal);
                }, 300);
            }
        });
        
        // Close on ESC
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && modal.classList.contains('active')) {
                modal.classList.remove('active');
                setTimeout(() => {
                    document.body.removeChild(modal);
                }, 300);
            }
        });
    });
    
    return photoContainer;
}

// Send requested photo (ChatGPT-style)
function sendRequestedPhoto(photoRequest, photoInfo) {
    // Simple bot response like ChatGPT
    const responses = [
        `Here's a photo of ${photoInfo.displayName}:`,
        `Here is ${photoInfo.displayName}:`,
        `${photoInfo.displayName}:`,
        `I found this photo of ${photoInfo.displayName}:`
    ];
    
    const randomResponse = responses[Math.floor(Math.random() * responses.length)];
    
    // Add bot message
    addMessage("CoffeeBot", randomResponse, false);
    
    // Add photo after short delay
    setTimeout(() => {
        const photoMessage = createPhotoMessage(photoInfo);
        
        // Create message container
        const messageDiv = document.createElement('div');
        messageDiv.className = 'message bot-message';
        
        messageDiv.innerHTML = `
            <div class="message-avatar">
                <i class="fas fa-robot"></i>
            </div>
            <div>
                <div class="message-content"></div>
                <div class="message-time">Just now</div>
            </div>
        `;
        
        // Insert photo
        const messageContent = messageDiv.querySelector('.message-content');
        messageContent.appendChild(photoMessage);
        
        // Add to chat
        const chatMessages = document.getElementById('chatMessages');
        if (chatMessages) {
            chatMessages.appendChild(messageDiv);
            scrollToBottom();
        }
        
    }, 500);
}

// Handle unknown photo requests
function handleUnknownPhoto(photoRequest) {
    const available = Object.keys(availablePhotos)
        .slice(0, 5)
        .map(name => `• ${name.charAt(0).toUpperCase() + name.slice(1)}`)
        .join('\n');
    
    addMessage("CoffeeBot", 
        `I don't have "${photoRequest}" in my photo collection. Here are some available:\n${available}\n\nTry: "honey singh photo" or "send picture of badshah"`, 
        false
    );
}

// Modify sendMessage function for photos
function modifySendMessageForPhotos() {
    const originalSendMessage = window.sendMessage;
    
    window.sendMessage = function() {
        const messageInput = document.getElementById('messageInput');
        if (!messageInput) return;
        
        const message = messageInput.value.trim();
        if (!message) return;
        
        // Check for website commands
        if (checkSpecialCommands(message)) {
            messageInput.value = '';
            return;
        }
        
        // Check for song request
        const songRequest = extractSongRequest && extractSongRequest(message);
        if (songRequest) {
            addMessage("You", message, true);
            messageInput.value = '';
            
            showTypingIndicator();
            
            setTimeout(() => {
                removeTypingIndicator();
                const songInfo = findMatchingSong && findMatchingSong(songRequest);
                
                if (songInfo) {
                    sendRequestedSong(songRequest, songInfo);
                } else {
                    handleUnknownSong && handleUnknownSong(songRequest);
                }
            }, 1000);
            
            return;
        }
        
        // Check for photo request
        const lowerMessage = message.toLowerCase();
        const isPhotoRequest = 
            lowerMessage.includes('photo') || 
            lowerMessage.includes('picture') || 
            lowerMessage.includes('image') ||
            Object.keys(availablePhotos).some(name => lowerMessage.includes(name));
        
        if (isPhotoRequest) {
            addMessage("You", message, true);
            messageInput.value = '';
            
            showTypingIndicator();
            
            setTimeout(() => {
                removeTypingIndicator();
                
                let foundCelebrity = null;
                for (const celebrity in availablePhotos) {
                    if (lowerMessage.includes(celebrity)) {
                        foundCelebrity = celebrity;
                        break;
                    }
                }
                
                if (foundCelebrity) {
                    const photoInfo = {
                        filename: availablePhotos[foundCelebrity],
                        displayName: foundCelebrity.charAt(0).toUpperCase() + foundCelebrity.slice(1)
                    };
                    sendRequestedPhoto(foundCelebrity, photoInfo);
                } else {
                    handleUnknownPhoto(message);
                }
            }, 1000);
            
            return;
        }
        
        // Original send message functionality
        if (originalSendMessage) {
            originalSendMessage();
        }
    };
}

// Initialize photo functionality
setTimeout(() => {
    modifySendMessageForPhotos();
    
    // Add simple hint
    setTimeout(() => {
        addMessage("CoffeeBot", "You can ask for celebrity photos: 'honey singh photo', 'send picture of badshah', etc.", false);
    }, 4000);
}, 1000);
// ====== END OF PHOTO FUNCTIONALITY ======


// ====== ADD PDF SENDING FUNCTIONALITY ======
// PDFs available in the pdfs folder
const availablePDFs = {
    "aktu syllabus": "aktu-syllabus.pdf",
    "aktu timetable": "aktu-timetable.pdf",
    "aktu previous papers": "aktu-previous-papers.pdf",
    "engineering mathematics": "engineering-mathematics.pdf",
    "physics syllabus": "physics-syllabus.pdf",
    "chemistry syllabus": "chemistry-syllabus.pdf",
    "computer science syllabus": "computer-science-syllabus.pdf",
    "mechanical engineering syllabus": "mechanical-engineering-syllabus.pdf",
    "electrical engineering syllabus": "electrical-engineering-syllabus.pdf",
    "civil engineering syllabus": "civil-engineering-syllabus.pdf",
    "placement preparation guide": "placement-preparation-guide.pdf",
    "resume template": "resume-template.pdf",
    "project report format": "project-report-format.pdf",
    "lab manual": "lab-manual.pdf",
    "worksheet solutions": "worksheet-solutions.pdf"
};

// Function to extract PDF request
function extractPDFRequest(message) {
    const lowerMessage = message.toLowerCase().trim();
    
    // Check if message contains any PDF-related keywords
    const pdfKeywords = ['pdf', 'document', 'file', 'notes', 'syllabus', 'paper', 'timetable'];
    const hasPDFKeyword = pdfKeywords.some(keyword => lowerMessage.includes(keyword));
    
    if (hasPDFKeyword) {
        // Extract the main content (remove PDF keywords and common words)
        let content = lowerMessage;
        pdfKeywords.forEach(keyword => {
            content = content.replace(keyword, '');
        });
        
        content = content.replace(/\b(send|show|get|give|me|please|a|the|of|for)\b/g, '');
        content = content.trim();
        
        return content || null;
    }
    
    // Check if message matches any PDF name
    for (const pdfName in availablePDFs) {
        if (lowerMessage.includes(pdfName)) {
            return pdfName;
        }
    }
    
    return null;
}

// Function to find matching PDF
function findMatchingPDF(pdfRequest) {
    if (!pdfRequest) return null;
    
    const lowerRequest = pdfRequest.toLowerCase();
    
    // Exact match
    if (availablePDFs[lowerRequest]) {
        return {
            filename: availablePDFs[lowerRequest],
            displayName: lowerRequest.charAt(0).toUpperCase() + lowerRequest.slice(1)
        };
    }
    
    // Partial match
    for (const [pdfName, filename] of Object.entries(availablePDFs)) {
        if (lowerRequest.includes(pdfName) || pdfName.includes(lowerRequest)) {
            return {
                filename: filename,
                displayName: pdfName.charAt(0).toUpperCase() + pdfName.slice(1)
            };
        }
    }
    
    // Word-by-word match
    const words = lowerRequest.split(' ');
    for (const [pdfName, filename] of Object.entries(availablePDFs)) {
        for (const word of words) {
            if (word.length > 3 && pdfName.includes(word)) {
                return {
                    filename: filename,
                    displayName: pdfName.charAt(0).toUpperCase() + pdfName.slice(1),
                    note: `Found similar PDF for "${pdfRequest}"`
                };
            }
        }
    }
    
    return null;
}

// Function to create WhatsApp-style PDF UI
function createPDFMessage(pdfInfo) {
    const pdfUrl = `pdfs/${pdfInfo.filename}`;
    const fileSize = "2.4 MB"; // You can make this dynamic if needed
    
    const pdfContainer = document.createElement('div');
    pdfContainer.className = 'pdf-message-container';
    
    // WhatsApp-style PDF UI - Changed: removed text from buttons
    pdfContainer.innerHTML = `
        <div class="pdf-message">
            <div class="pdf-header">
                <div class="pdf-icon">
                    <i class="fas fa-file-pdf"></i>
                </div>
                <div class="pdf-info">
                    <div class="pdf-title">${pdfInfo.displayName}.pdf</div>
                    <div class="pdf-subtitle">PDF Document • ${fileSize}</div>
                </div>
            </div>
            <div class="pdf-actions">
                <button class="pdf-action-btn preview-btn" title="Preview PDF">
                    <i class="fas fa-eye"></i>
                </button>
                <button class="pdf-action-btn download-btn" title="Download PDF">
                    <i class="fas fa-download"></i>
                </button>
            </div>
        </div>
    `;
    
    // Add styles for PDF message
    if (!document.querySelector('#pdf-message-styles')) {
        const style = document.createElement('style');
        style.id = 'pdf-message-styles';
        style.textContent = `
            /* PDF Message Container */
            .pdf-message-container {
                margin: 10px 0;
                animation: slideIn 0.3s ease;
                max-width: 300px;
            }
            
            @keyframes slideIn {
                from { 
                    opacity: 0; 
                    transform: translateY(10px); 
                }
                to { 
                    opacity: 1; 
                    transform: translateY(0); 
                }
            }
            
            /* WhatsApp-style PDF Message */
            .pdf-message {
                background: linear-gradient(135deg, #d32f2f 0%, #b71c1c 100%);
                border-radius: 15px;
                padding: 15px;
                color: white;
                box-shadow: 0 4px 15px rgba(211, 47, 47, 0.3);
                border: 1px solid rgba(255, 255, 255, 0.1);
            }
            
            .pdf-header {
                display: flex;
                align-items: center;
                gap: 15px;
                margin-bottom: 15px;
                padding-bottom: 15px;
                border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            }
            
            .pdf-icon {
                width: 50px;
                height: 50px;
                background: rgba(255, 255, 255, 0.1);
                border-radius: 10px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 1.8rem;
                color: #ffebee;
            }
            
            .pdf-info {
                flex: 1;
                min-width: 0;
            }
            
            .pdf-title {
                font-weight: 600;
                font-size: 0.95rem;
                margin-bottom: 4px;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
            }
            
            .pdf-subtitle {
                font-size: 0.8rem;
                opacity: 0.9;
            }
            
            .pdf-actions {
                display: flex;
                gap: 10px;
            }
            
            /* Changed: Buttons with only icons, no text */
            .pdf-action-btn {
                flex: 1;
                background: rgba(255, 255, 255, 0.15);
                border: 1px solid rgba(255, 255, 255, 0.2);
                color: white;
                padding: 10px;
                border-radius: 8px;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                transition: all 0.2s ease;
                min-width: 44px; /* Minimum touch target size */
            }
            
            .pdf-action-btn:hover {
                background: rgba(255, 255, 255, 0.25);
                transform: translateY(-2px);
            }
            
            .pdf-action-btn:active {
                transform: translateY(0);
            }
            
            .pdf-action-btn i {
                font-size: 1.2rem; /* Slightly larger icons */
            }
            
            /* Removed span styles since we're removing text */
            
            /* PDF Preview Modal */
            .pdf-preview-modal {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.95);
                display: none;
                justify-content: center;
                align-items: center;
                z-index: 10000;
                animation: fadeIn 0.3s ease;
            }
            
            .pdf-preview-modal.active {
                display: flex;
            }
            
            @keyframes fadeIn {
                from { opacity: 0; }
                to { opacity: 1; }
            }
            
            .preview-content {
                width: 90%;
                height: 90%;
                background: white;
                border-radius: 10px;
                overflow: hidden;
                display: flex;
                flex-direction: column;
            }
            
            .preview-header {
                background: #d32f2f;
                color: white;
                padding: 15px 20px;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }
            
            .preview-title {
                font-weight: 600;
                font-size: 1rem;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
                max-width: 70%;
            }
            
            .preview-controls {
                display: flex;
                gap: 10px;
            }
            
            .preview-btn {
                background: rgba(255, 255, 255, 0.2);
                border: none;
                color: white;
                width: 36px;
                height: 36px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                transition: all 0.2s ease;
            }
            
            .preview-btn:hover {
                background: rgba(255, 255, 255, 0.3);
                transform: scale(1.1);
            }
            
            .preview-body {
                flex: 1;
                display: flex;
                justify-content: center;
                align-items: center;
                padding: 20px;
                background: #f5f5f5;
            }
            
            .pdf-preview {
                width: 100%;
                height: 100%;
                border: none;
                background: white;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            }
            
            .preview-footer {
                background: white;
                padding: 15px 20px;
                border-top: 1px solid #e0e0e0;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }
            
            .preview-download-btn {
                background: #d32f2f;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 6px;
                display: flex;
                align-items: center;
                gap: 8px;
                cursor: pointer;
                font-weight: 500;
                transition: all 0.2s ease;
            }
            
            .preview-download-btn:hover {
                background: #b71c1c;
                transform: translateY(-2px);
            }
            
            /* Toast Notification */
            .pdf-toast {
                position: fixed;
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%) translateY(100px);
                background: #d32f2f;
                color: white;
                padding: 12px 20px;
                border-radius: 25px;
                box-shadow: 0 5px 15px rgba(211, 47, 47, 0.3);
                z-index: 10001;
                display: flex;
                align-items: center;
                gap: 10px;
                font-weight: 500;
                opacity: 0;
                transition: all 0.3s ease;
            }
            
            .pdf-toast.show {
                transform: translateX(-50%) translateY(0);
                opacity: 1;
            }
            
            .pdf-toast i {
                animation: pulse 1s infinite;
            }
            
            @keyframes pulse {
                0%, 100% { transform: scale(1); }
                50% { transform: scale(1.1); }
            }
        `;
        document.head.appendChild(style);
    }
    
    // Add event listeners
    const downloadBtn = pdfContainer.querySelector('.download-btn');
    const previewBtn = pdfContainer.querySelector('.preview-btn');
    
    // Download functionality
    downloadBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        downloadPDF(pdfUrl, `${pdfInfo.displayName}.pdf`);
    });
    
    // Preview functionality
    previewBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        openPDFPreview(pdfUrl, pdfInfo.displayName);
    });
    
    return pdfContainer;
}

// Download PDF function
function downloadPDF(url, filename) {
    const a = document.createElement('a');
    a.href = url;
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    
    showPDFToast('Download started...');
}

// Open PDF in preview modal
function openPDFPreview(url, title) {
    // Create modal
    const modal = document.createElement('div');
    modal.className = 'pdf-preview-modal';
    
    modal.innerHTML = `
        <div class="preview-content">
            <div class="preview-header">
                <div class="preview-title">${title}.pdf</div>
                <div class="preview-controls">
                    <button class="preview-btn open-external-btn" title="Open in new tab">
                        <i class="fas fa-external-link-alt"></i>
                    </button>
                    <button class="preview-btn close-preview-btn" title="Close">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div class="preview-body">
                <iframe src="${url}" class="pdf-preview" 
                        title="${title} PDF Preview"></iframe>
            </div>
            <div class="preview-footer">
                <div style="font-size: 0.9rem; color: #666;">
                    <i class="fas fa-info-circle"></i> Scroll to navigate • Use browser controls
                </div>
                <button class="preview-download-btn">
                    <i class="fas fa-download"></i>
                    Download PDF
                </button>
            </div>
        </div>
    `;
    
    document.body.appendChild(modal);
    
    // Show modal
    setTimeout(() => {
        modal.classList.add('active');
    }, 10);
    
    // Get modal elements
    const closeBtn = modal.querySelector('.close-preview-btn');
    const externalBtn = modal.querySelector('.open-external-btn');
    const downloadBtn = modal.querySelector('.preview-download-btn');
    
    // Close modal
    closeBtn.addEventListener('click', () => {
        modal.classList.remove('active');
        setTimeout(() => {
            document.body.removeChild(modal);
        }, 300);
    });
    
    // Open in new tab
    externalBtn.addEventListener('click', () => {
        window.open(url, '_blank');
        showPDFToast('Opening in new tab...');
    });
    
    // Download from modal
    downloadBtn.addEventListener('click', () => {
        downloadPDF(url, `${title}.pdf`);
    });
    
    // Close on ESC
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && modal.classList.contains('active')) {
            modal.classList.remove('active');
            setTimeout(() => {
                document.body.removeChild(modal);
            }, 300);
        }
    });
    
    // Close on background click
    modal.addEventListener('click', function(e) {
        if (e.target === modal) {
            modal.classList.remove('active');
            setTimeout(() => {
                document.body.removeChild(modal);
            }, 300);
        }
    });
}

// Show toast notification
function showPDFToast(message) {
    let toast = document.querySelector('.pdf-toast');
    if (!toast) {
        toast = document.createElement('div');
        toast.className = 'pdf-toast';
        document.body.appendChild(toast);
    }
    
    toast.innerHTML = `<i class="fas fa-file-pdf"></i> ${message}`;
    
    // Show toast
    setTimeout(() => {
        toast.classList.add('show');
    }, 10);
    
    // Hide after 3 seconds
    setTimeout(() => {
        toast.classList.remove('show');
    }, 3000);
}

// Send requested PDF
function sendRequestedPDF(pdfRequest, pdfInfo) {
    // Bot responses
    const responses = [
        `📄 Here's the PDF for ${pdfInfo.displayName}:`,
        `📚 Found ${pdfInfo.displayName} PDF for you:`,
        `📑 Sending ${pdfInfo.displayName} PDF:`,
        `📖 Here's the ${pdfInfo.displayName} document:`
    ];
    
    const randomResponse = responses[Math.floor(Math.random() * responses.length)];
    
    // Add bot message
    addMessage("CoffeeBot", randomResponse, false);
    
    // Add note if it's a similar match
    if (pdfInfo.note) {
        setTimeout(() => {
            addMessage("CoffeeBot", pdfInfo.note, false);
        }, 300);
    }
    
    // Add PDF message after delay
    setTimeout(() => {
        const pdfMessage = createPDFMessage(pdfInfo);
        
        // Create message container
        const messageDiv = document.createElement('div');
        messageDiv.className = 'message bot-message';
        
        messageDiv.innerHTML = `
            <div class="message-avatar">
                <i class="fas fa-robot"></i>
            </div>
            <div>
                <div class="message-content"></div>
                <div class="message-time">Just now</div>
            </div>
        `;
        
        // Insert PDF
        const messageContent = messageDiv.querySelector('.message-content');
        messageContent.appendChild(pdfMessage);
        
        // Add to chat
        const chatMessages = document.getElementById('chatMessages');
        if (chatMessages) {
            chatMessages.appendChild(messageDiv);
            scrollToBottom();
        }
        
        // Update instruction message to reflect icon-only buttons
        setTimeout(() => {
            addMessage("CoffeeBot", "Click the 👁️ eye icon to preview or the ⬇️ download icon to save the PDF. 📥", false);
        }, 1000);
        
    }, 800);
}

// Handle unknown PDF requests
function handleUnknownPDF(pdfRequest) {
    const available = Object.keys(availablePDFs)
        .slice(0, 6)
        .map(name => `• ${name.charAt(0).toUpperCase() + name.slice(1)}`)
        .join('\n');
    
    addMessage("CoffeeBot", 
        `📭 I couldn't find "${pdfRequest}" in my PDF collection.\n\n📚 Available PDFs:\n${available}\n\n💡 Try: "aktu syllabus pdf" or "placement preparation guide"`, 
        false
    );
}

// Modify sendMessage function for PDFs
function modifySendMessageForPDFs() {
    const currentSendMessage = window.sendMessage;
    
    window.sendMessage = function() {
        const messageInput = document.getElementById('messageInput');
        if (!messageInput) return;
        
        const message = messageInput.value.trim();
        if (!message) return;
        
        // Check for website commands
        if (checkSpecialCommands(message)) {
            messageInput.value = '';
            return;
        }
        
        // Check for song request
        const songRequest = extractSongRequest && extractSongRequest(message);
        if (songRequest) {
            addMessage("You", message, true);
            messageInput.value = '';
            
            showTypingIndicator();
            
            setTimeout(() => {
                removeTypingIndicator();
                const songInfo = findMatchingSong && findMatchingSong(songRequest);
                
                if (songInfo) {
                    sendRequestedSong(songRequest, songInfo);
                } else {
                    handleUnknownSong && handleUnknownSong(songRequest);
                }
            }, 1000);
            
            return;
        }
        
        // Check for photo request
        const photoRequest = extractPhotoRequest && extractPhotoRequest(message);
        if (photoRequest) {
            addMessage("You", message, true);
            messageInput.value = '';
            
            showTypingIndicator();
            
            setTimeout(() => {
                removeTypingIndicator();
                const photoInfo = findMatchingPhoto && findMatchingPhoto(photoRequest);
                
                if (photoInfo) {
                    sendRequestedPhoto(photoRequest, photoInfo);
                } else {
                    handleUnknownPhoto && handleUnknownPhoto(photoRequest);
                }
            }, 1000);
            
            return;
        }
        
        // Check for PDF request (NEW)
        const lowerMessage = message.toLowerCase();
        const isPDFRequest = 
            lowerMessage.includes('pdf') || 
            lowerMessage.includes('document') || 
            lowerMessage.includes('syllabus') ||
            lowerMessage.includes('notes') ||
            lowerMessage.includes('paper') ||
            lowerMessage.includes('timetable') ||
            Object.keys(availablePDFs).some(name => lowerMessage.includes(name));
        
        if (isPDFRequest) {
            addMessage("You", message, true);
            messageInput.value = '';
            
            showTypingIndicator();
            
            setTimeout(() => {
                removeTypingIndicator();
                
                // Try to find matching PDF
                const pdfRequest = extractPDFRequest(message);
                let pdfInfo = null;
                
                if (pdfRequest) {
                    pdfInfo = findMatchingPDF(pdfRequest);
                }
                
                if (!pdfInfo) {
                    // Search directly
                    for (const pdfName in availablePDFs) {
                        if (lowerMessage.includes(pdfName)) {
                            pdfInfo = {
                                filename: availablePDFs[pdfName],
                                displayName: pdfName.charAt(0).toUpperCase() + pdfName.slice(1)
                            };
                            break;
                        }
                    }
                }
                
                if (pdfInfo) {
                    sendRequestedPDF(pdfRequest || message, pdfInfo);
                } else {
                    handleUnknownPDF(pdfRequest || message);
                }
            }, 1000);
            
            return;
        }
        
        // Original send message functionality
        if (currentSendMessage) {
            currentSendMessage();
        }
    };
}

// Initialize PDF functionality
setTimeout(() => {
    modifySendMessageForPDFs();
    
    // Add hint about PDFs
    setTimeout(() => {
        addMessage("CoffeeBot", 
            "📚 <strong>PDF Library:</strong> I can send educational PDFs!\n\n" +
            "Try: <strong>'aktu syllabus pdf'</strong>, <strong>'placement preparation guide'</strong>, or <strong>'resume template'</strong>\n" +
            "Features: 👁️ Preview • ⬇️ Download • WhatsApp-style UI", 
            false
        );
    }, 6000);
    
    // Add PDF quick action
    const quickActions = document.getElementById('quickActions');
    if (quickActions) {
        const pdfAction = document.createElement('div');
        pdfAction.className = 'action-chip';
        pdfAction.innerHTML = '<i class="fas fa-file-pdf"></i> Get PDF';
        pdfAction.addEventListener('click', function() {
            const pdfs = Object.keys(availablePDFs)
                .slice(0, 4)
                .map(name => `• ${name.charAt(0).toUpperCase() + name.slice(1)}`)
                .join('\n');
            
            addMessage("CoffeeBot", 
                `📚 Quick PDF Access:\n${pdfs}\n\n💡 Try: "aktu syllabus pdf" or tap any name above!`, 
                false
            );
        });
        quickActions.appendChild(pdfAction);
    }
    
}, 1500);

// Add to sassy chips
if (sassyChips && Array.isArray(sassyChips)) {
    sassyChips.push("AKTU syllabus pdf", "Send notes", "PDF please");
    
    // Re-render chips if functions exist
    if (typeof renderSassyChips === 'function') {
        renderSassyChips('sassyRepliesDesktop');
        renderSassyChips('sassyRepliesMobile');
    }
}
// ====== END OF PDF FUNCTIONALITY ======


</script>
</body>
</html>